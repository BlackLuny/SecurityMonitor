<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Security Monitor: monitor_util.c 파일 참조</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Security Monitor
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 다음에 의해 생성됨 :  Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'검색');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>메인&#160;페이지</span></a></li>
      <li><a href="annotated.html"><span>데이타&#160;구조</span></a></li>
      <li class="current"><a href="files.html"><span>파일들</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="검색" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>파일&#160;목록</span></a></li>
      <li><a href="globals.html"><span>전역</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>모두</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>데이타 구조</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>파일들</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>함수</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>변수</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>타입정의</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>열거형 타입</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>열거형 멤버</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>매크로</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">함수</a>  </div>
  <div class="headertitle">
<div class="title">monitor_util.c 파일 참조</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file includes some implementations of some utility functions.  
<a href="#details">더 자세히 ...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="monitor__util_8h_source.html">monitor_util.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="monitor__ept_8h_source.html">monitor_ept.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="guest__state_8h_source.html">guest_state.h</a>&gt;</code><br/>
</div><div class="textblock"><div class="dynheader">
monitor_util.c에 대한 include 의존 그래프</div>
<div class="dyncontent">
<div class="center"><img src="monitor__util_8c__incl.png" border="0" usemap="#monitor__util_8c" alt=""/></div>
<map name="monitor__util_8c" id="monitor__util_8c">
<area shape="rect" id="node2" href="monitor__util_8h.html" title="This file exists for supporting some uiility functions. " alt="" coords="5,155,104,181"/><area shape="rect" id="node4" href="monitor__ept_8h.html" title="This file declares some EPT&#45;related functions and defines EPT&#45;related constants. " alt="" coords="92,80,193,107"/><area shape="rect" id="node5" href="guest__state_8h.html" title="High&#45;level facilities to get guest VM&#39;s information. " alt="" coords="217,80,319,107"/><area shape="rect" id="node3" href="monitor__types_8h.html" title="Definitions of types that are used in this project. " alt="" coords="112,229,227,256"/><area shape="rect" id="node6" href="vmcs_8h.html" title="Definition of constants related to VMCS. " alt="" coords="235,155,297,181"/></map>
</div>
</div>
<p><a href="monitor__util_8c_source.html">이 파일의 소스 코드 페이지로 가기</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
함수</h2></td></tr>
<tr class="memitem:a19ca3fbdba02a8a291fbf56b030e7323"><td class="memItemLeft" align="right" valign="top"><a class="el" href="monitor__types_8h.html#a35e867d4f252496befeb6d260a03acac">HPA_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monitor__util_8c.html#a19ca3fbdba02a8a291fbf56b030e7323">gpaToHPA</a> (const <a class="el" href="monitor__types_8h.html#a25ec30a201a5e2d4bdd7b40a89014d5c">GPA_t</a> gpa, <a class="el" href="monitor__types_8h.html#a35e867d4f252496befeb6d260a03acac">HPA_t</a> *eptEntryHPA)</td></tr>
<tr class="memdesc:a19ca3fbdba02a8a291fbf56b030e7323"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function converts guest physical address to host physical address.  <a href="#a19ca3fbdba02a8a291fbf56b030e7323">더 자세히 ...</a><br/></td></tr>
<tr class="separator:a19ca3fbdba02a8a291fbf56b030e7323"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c5054946f567612d0ad5878def288f3"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monitor__util_8c.html#a5c5054946f567612d0ad5878def288f3">mapHPAintoHVA</a> (const <a class="el" href="monitor__types_8h.html#a35e867d4f252496befeb6d260a03acac">HPA_t</a> hpa, const <a class="el" href="monitor__types_8h.html#a822913f05423d4a8faac6dfec8bc1617">U64_t</a> size)</td></tr>
<tr class="memdesc:a5c5054946f567612d0ad5878def288f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function maps host physical address into hypervisor's virtual memory.  <a href="#a5c5054946f567612d0ad5878def288f3">더 자세히 ...</a><br/></td></tr>
<tr class="separator:a5c5054946f567612d0ad5878def288f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5b8234f7d553177a9d3f932fe1c112b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monitor__util_8c.html#ae5b8234f7d553177a9d3f932fe1c112b">unmapHPAintoHVA</a> (void *hva, const <a class="el" href="monitor__types_8h.html#a822913f05423d4a8faac6dfec8bc1617">U64_t</a> size)</td></tr>
<tr class="memdesc:ae5b8234f7d553177a9d3f932fe1c112b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function maps host physical address into hypervisor's virtual memory.  <a href="#ae5b8234f7d553177a9d3f932fe1c112b">더 자세히 ...</a><br/></td></tr>
<tr class="separator:ae5b8234f7d553177a9d3f932fe1c112b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">상세한 설명</h2>
<div class="textblock"><p>This file includes some implementations of some utility functions. </p>

<p><a class="el" href="monitor__util_8c_source.html">monitor_util.c</a> 파일에서 정의되었습니다.</p>
</div><h2 class="groupheader">함수 문서화</h2>
<a class="anchor" id="a19ca3fbdba02a8a291fbf56b030e7323"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="monitor__types_8h.html#a35e867d4f252496befeb6d260a03acac">HPA_t</a> gpaToHPA </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="monitor__types_8h.html#a25ec30a201a5e2d4bdd7b40a89014d5c">GPA_t</a>&#160;</td>
          <td class="paramname"><em>gpa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="monitor__types_8h.html#a35e867d4f252496befeb6d260a03acac">HPA_t</a> *&#160;</td>
          <td class="paramname"><em>eptEntryHPA</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function converts guest physical address to host physical address. </p>
<dl class="section return"><dt>반환값</dt><dd>This function returns converted HPA, and HPA of EPT entry of returned HPA.</dd></dl>
<p>Detail.</p>
<p>This function converts guest physical address (GPA) to host physical address (HPA).<br/>
To do this, this function traverses the current guest's page table from PML4 to page table.<br/>
And, it also returns HPA of EPT entry of converted HPA.<br/>
For more information, see <b>Intel's Architecture Manual Vol. 3, Chapter 28.2.2 : EPT Tranlation Mechanism</b>. </p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">gpa</td><td>Guest physical address to convert </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">eptEntryHPA</td><td>HPA of EPT entry of the returned HPA </td></tr>
  </table>
  </dd>
</dl>

<p><a class="el" href="monitor__util_8c_source.html">monitor_util.c</a> 파일의 <a class="el" href="monitor__util_8c_source.html#l00014">14</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;{</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <a class="code" href="monitor__types_8h.html#a35e867d4f252496befeb6d260a03acac">HPA_t</a> eptBaseHPA;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <a class="code" href="monitor__types_8h.html#a35e867d4f252496befeb6d260a03acac">HPA_t</a> currentEPT_PML4_Entry_HPA;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <a class="code" href="monitor__types_8h.html#ae2a9c06a03ebe51122eda7315fbeb5b0">EPT_ENTRY_t</a> *pCurrentEPT_PML4_Entry, currentEPT_PML4_Entry;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <a class="code" href="monitor__types_8h.html#a35e867d4f252496befeb6d260a03acac">HPA_t</a> eptBase_PDP_HPA;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <a class="code" href="monitor__types_8h.html#a35e867d4f252496befeb6d260a03acac">HPA_t</a> currentEPT_PDP_Entry_HPA;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <a class="code" href="monitor__types_8h.html#ae2a9c06a03ebe51122eda7315fbeb5b0">EPT_ENTRY_t</a> *pCurrentEPT_PDP_Entry, currentEPT_PDP_Entry;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <a class="code" href="monitor__types_8h.html#a35e867d4f252496befeb6d260a03acac">HPA_t</a> eptBase_PD_HPA;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <a class="code" href="monitor__types_8h.html#a35e867d4f252496befeb6d260a03acac">HPA_t</a> currentEPT_PD_Entry_HPA;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <a class="code" href="monitor__types_8h.html#ae2a9c06a03ebe51122eda7315fbeb5b0">EPT_ENTRY_t</a> *pCurrentEPT_PD_Entry, currentEPT_PD_Entry; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <a class="code" href="monitor__types_8h.html#a35e867d4f252496befeb6d260a03acac">HPA_t</a> eptBase_PT_HPA;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <a class="code" href="monitor__types_8h.html#a35e867d4f252496befeb6d260a03acac">HPA_t</a> currentEPT_PT_Entry_HPA;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="monitor__types_8h.html#ae2a9c06a03ebe51122eda7315fbeb5b0">EPT_ENTRY_t</a> *pCurrentEPT_PT_Entry, currentEPT_PT_Entry;     </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="monitor__types_8h.html#a35e867d4f252496befeb6d260a03acac">HPA_t</a> pageFrameHPA;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    eptBaseHPA = <a class="code" href="guest__state_8c.html#a33fb594e7472da1af81f2abf272a64b2">get_ept_base_HPA</a>();</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    currentEPT_PML4_Entry_HPA = eptBaseHPA | ((gpa &amp; <a class="code" href="monitor__ept_8h.html#ace14d38a20945cb7618b39812883005c">EPT_PML4_GPA_MASK</a>) &gt;&gt; <a class="code" href="monitor__ept_8h.html#a3ce3f0ab82d640f2e804b9731ad40372">EPT_PML4_GPA_SHIFT</a>);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    pCurrentEPT_PML4_Entry = (<a class="code" href="monitor__types_8h.html#ae2a9c06a03ebe51122eda7315fbeb5b0">EPT_ENTRY_t</a>*)<a class="code" href="monitor__util_8c.html#a5c5054946f567612d0ad5878def288f3">mapHPAintoHVA</a>(currentEPT_PML4_Entry_HPA,<span class="keyword">sizeof</span>(<a class="code" href="monitor__types_8h.html#ae2a9c06a03ebe51122eda7315fbeb5b0">EPT_ENTRY_t</a>));</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordflow">if</span>(!pCurrentEPT_PML4_Entry)</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    currentEPT_PML4_Entry = *pCurrentEPT_PML4_Entry;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="monitor__util_8c.html#ae5b8234f7d553177a9d3f932fe1c112b">unmapHPAintoHVA</a>((<span class="keywordtype">void</span>*)pCurrentEPT_PML4_Entry,<span class="keyword">sizeof</span>(<a class="code" href="monitor__types_8h.html#ae2a9c06a03ebe51122eda7315fbeb5b0">EPT_ENTRY_t</a>));</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    eptBase_PDP_HPA = currentEPT_PML4_Entry &amp; <a class="code" href="guest___i_a32e_page_8h.html#a71ab36e768a6cf0cff31a9e288abe306">EPT_PML4_ENTRY_MASK</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    currentEPT_PDP_Entry_HPA = eptBase_PDP_HPA | ((gpa &amp; <a class="code" href="monitor__ept_8h.html#a2cc4d274ab4b1835614390ec864191fe">EPT_PDP_GPA_MASK</a>) &gt;&gt; <a class="code" href="monitor__ept_8h.html#a945351fadae2a2f125144db6a7e943c0">EPT_PDP_GPA_SHIFT</a>);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    pCurrentEPT_PDP_Entry = (<a class="code" href="monitor__types_8h.html#ae2a9c06a03ebe51122eda7315fbeb5b0">EPT_ENTRY_t</a>*)<a class="code" href="monitor__util_8c.html#a5c5054946f567612d0ad5878def288f3">mapHPAintoHVA</a>(currentEPT_PDP_Entry_HPA,<span class="keyword">sizeof</span>(<a class="code" href="monitor__types_8h.html#ae2a9c06a03ebe51122eda7315fbeb5b0">EPT_ENTRY_t</a>));</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">if</span>(!pCurrentEPT_PDP_Entry)</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    currentEPT_PDP_Entry = *pCurrentEPT_PDP_Entry;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="monitor__util_8c.html#ae5b8234f7d553177a9d3f932fe1c112b">unmapHPAintoHVA</a>((<span class="keywordtype">void</span>*)pCurrentEPT_PDP_Entry,<span class="keyword">sizeof</span>(<a class="code" href="monitor__types_8h.html#ae2a9c06a03ebe51122eda7315fbeb5b0">EPT_ENTRY_t</a>));</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    eptBase_PD_HPA = currentEPT_PDP_Entry &amp; <a class="code" href="guest___i_a32e_page_8h.html#aca4d6718af5283d4aa065fac24e64e54">EPT_PDP_ENTRY_MASK</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    currentEPT_PD_Entry_HPA = eptBase_PD_HPA | ((gpa &amp; <a class="code" href="monitor__ept_8h.html#abf806e0ba2ec2f5405e3ef9701d8a737">EPT_PD_GPA_MASK</a>) &gt;&gt; <a class="code" href="monitor__ept_8h.html#aa06a29042c653e73fca00adc8fd7d663">EPT_PD_GPA_SHIFT</a>);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    pCurrentEPT_PD_Entry = (<a class="code" href="monitor__types_8h.html#ae2a9c06a03ebe51122eda7315fbeb5b0">EPT_ENTRY_t</a>*)<a class="code" href="monitor__util_8c.html#a5c5054946f567612d0ad5878def288f3">mapHPAintoHVA</a>(currentEPT_PD_Entry_HPA,<span class="keyword">sizeof</span>(<a class="code" href="monitor__types_8h.html#ae2a9c06a03ebe51122eda7315fbeb5b0">EPT_ENTRY_t</a>));</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">if</span>(!pCurrentEPT_PD_Entry)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    }   </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    currentEPT_PD_Entry = *pCurrentEPT_PD_Entry;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="monitor__util_8c.html#ae5b8234f7d553177a9d3f932fe1c112b">unmapHPAintoHVA</a>((<span class="keywordtype">void</span>*)pCurrentEPT_PD_Entry,<span class="keyword">sizeof</span>(<a class="code" href="monitor__types_8h.html#ae2a9c06a03ebe51122eda7315fbeb5b0">EPT_ENTRY_t</a>));</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    eptBase_PT_HPA = currentEPT_PD_Entry &amp; <a class="code" href="guest___i_a32e_page_8h.html#a23ff1894aab21877ab61e8d453aacaec">EPT_PD_ENTRY_MASK</a>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    currentEPT_PT_Entry_HPA = eptBase_PT_HPA | ((gpa &amp; <a class="code" href="monitor__ept_8h.html#a6f24b0fd49793bb5746899f709fbf171">EPT_PT_GPA_MASK</a>) &gt;&gt; <a class="code" href="monitor__ept_8h.html#a95ef0343cf64ff4f5c3a519d24d131dc">EPT_PT_GPA_SHIFT</a>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    pCurrentEPT_PT_Entry = (<a class="code" href="monitor__types_8h.html#ae2a9c06a03ebe51122eda7315fbeb5b0">EPT_ENTRY_t</a>*)<a class="code" href="monitor__util_8c.html#a5c5054946f567612d0ad5878def288f3">mapHPAintoHVA</a>(currentEPT_PT_Entry_HPA,<span class="keyword">sizeof</span>(<a class="code" href="monitor__types_8h.html#ae2a9c06a03ebe51122eda7315fbeb5b0">EPT_ENTRY_t</a>));</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">if</span>(pCurrentEPT_PT_Entry)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    currentEPT_PT_Entry = *pCurrentEPT_PT_Entry;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">if</span>(eptEntryHPA)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        *eptEntryHPA = currentEPT_PT_Entry_HPA; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="monitor__util_8c.html#ae5b8234f7d553177a9d3f932fe1c112b">unmapHPAintoHVA</a>((<span class="keywordtype">void</span>*)pCurrentEPT_PT_Entry,<span class="keyword">sizeof</span>(<a class="code" href="monitor__types_8h.html#ae2a9c06a03ebe51122eda7315fbeb5b0">EPT_ENTRY_t</a>));</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    pageFrameHPA = ((currentEPT_PT_Entry &amp; <a class="code" href="guest___i_a32e_page_8h.html#a369c8c91c392e3da4f0368c4640563df">EPT_PT_ENTRY_MASK</a>) | (gpa &amp; <a class="code" href="monitor__ept_8h.html#a666c4ed20e984021f4fd95a52bd2144f">EPT_GPA_MASK</a>));</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">return</span> pageFrameHPA;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;}</div>
<div class="ttc" id="guest___i_a32e_page_8h_html_a71ab36e768a6cf0cff31a9e288abe306"><div class="ttname"><a href="guest___i_a32e_page_8h.html#a71ab36e768a6cf0cff31a9e288abe306">EPT_PML4_ENTRY_MASK</a></div><div class="ttdeci">#define EPT_PML4_ENTRY_MASK</div><div class="ttdoc">A mask that is used to extract base HPA of EPT PDP from EPT PML4 entry. </div><div class="ttdef"><b>Definition:</b> <a href="guest___i_a32e_page_8h_source.html#l00178">guest_IA32ePage.h:178</a></div></div>
<div class="ttc" id="monitor__ept_8h_html_a945351fadae2a2f125144db6a7e943c0"><div class="ttname"><a href="monitor__ept_8h.html#a945351fadae2a2f125144db6a7e943c0">EPT_PDP_GPA_SHIFT</a></div><div class="ttdeci">#define EPT_PDP_GPA_SHIFT</div><div class="ttdoc">A right-shift value for EPT-PDP entry address calculation. </div><div class="ttdef"><b>Definition:</b> <a href="monitor__ept_8h_source.html#l00175">monitor_ept.h:175</a></div></div>
<div class="ttc" id="guest___i_a32e_page_8h_html_a369c8c91c392e3da4f0368c4640563df"><div class="ttname"><a href="guest___i_a32e_page_8h.html#a369c8c91c392e3da4f0368c4640563df">EPT_PT_ENTRY_MASK</a></div><div class="ttdeci">#define EPT_PT_ENTRY_MASK</div><div class="ttdoc">A mask that is used to extract base HPA of page from EPT page table entry. </div><div class="ttdef"><b>Definition:</b> <a href="guest___i_a32e_page_8h_source.html#l00181">guest_IA32ePage.h:181</a></div></div>
<div class="ttc" id="monitor__ept_8h_html_a666c4ed20e984021f4fd95a52bd2144f"><div class="ttname"><a href="monitor__ept_8h.html#a666c4ed20e984021f4fd95a52bd2144f">EPT_GPA_MASK</a></div><div class="ttdeci">#define EPT_GPA_MASK</div><div class="ttdoc">A mask used to extract HPA of EPT entry from GPA. </div><div class="ttdef"><b>Definition:</b> <a href="monitor__ept_8h_source.html#l00167">monitor_ept.h:167</a></div></div>
<div class="ttc" id="monitor__ept_8h_html_aa06a29042c653e73fca00adc8fd7d663"><div class="ttname"><a href="monitor__ept_8h.html#aa06a29042c653e73fca00adc8fd7d663">EPT_PD_GPA_SHIFT</a></div><div class="ttdeci">#define EPT_PD_GPA_SHIFT</div><div class="ttdoc">A right-shift value for EPT-PD entry address calculation. </div><div class="ttdef"><b>Definition:</b> <a href="monitor__ept_8h_source.html#l00176">monitor_ept.h:176</a></div></div>
<div class="ttc" id="guest___i_a32e_page_8h_html_aca4d6718af5283d4aa065fac24e64e54"><div class="ttname"><a href="guest___i_a32e_page_8h.html#aca4d6718af5283d4aa065fac24e64e54">EPT_PDP_ENTRY_MASK</a></div><div class="ttdeci">#define EPT_PDP_ENTRY_MASK</div><div class="ttdoc">A mask that is used to extract base HPA of EPT PDP from EPT PDP table entry. </div><div class="ttdef"><b>Definition:</b> <a href="guest___i_a32e_page_8h_source.html#l00179">guest_IA32ePage.h:179</a></div></div>
<div class="ttc" id="guest___i_a32e_page_8h_html_a23ff1894aab21877ab61e8d453aacaec"><div class="ttname"><a href="guest___i_a32e_page_8h.html#a23ff1894aab21877ab61e8d453aacaec">EPT_PD_ENTRY_MASK</a></div><div class="ttdeci">#define EPT_PD_ENTRY_MASK</div><div class="ttdoc">A mask that is used to extract base HPA of EPT PT from EPT PD table entry. </div><div class="ttdef"><b>Definition:</b> <a href="guest___i_a32e_page_8h_source.html#l00180">guest_IA32ePage.h:180</a></div></div>
<div class="ttc" id="monitor__ept_8h_html_a2cc4d274ab4b1835614390ec864191fe"><div class="ttname"><a href="monitor__ept_8h.html#a2cc4d274ab4b1835614390ec864191fe">EPT_PDP_GPA_MASK</a></div><div class="ttdeci">#define EPT_PDP_GPA_MASK</div><div class="ttdoc">A mask used to extract HPA of EPT entry from GPA. </div><div class="ttdef"><b>Definition:</b> <a href="monitor__ept_8h_source.html#l00170">monitor_ept.h:170</a></div></div>
<div class="ttc" id="monitor__ept_8h_html_a6f24b0fd49793bb5746899f709fbf171"><div class="ttname"><a href="monitor__ept_8h.html#a6f24b0fd49793bb5746899f709fbf171">EPT_PT_GPA_MASK</a></div><div class="ttdeci">#define EPT_PT_GPA_MASK</div><div class="ttdoc">A mask used to extract HPA of EPT entry from GPA. </div><div class="ttdef"><b>Definition:</b> <a href="monitor__ept_8h_source.html#l00172">monitor_ept.h:172</a></div></div>
<div class="ttc" id="monitor__util_8c_html_ae5b8234f7d553177a9d3f932fe1c112b"><div class="ttname"><a href="monitor__util_8c.html#ae5b8234f7d553177a9d3f932fe1c112b">unmapHPAintoHVA</a></div><div class="ttdeci">void unmapHPAintoHVA(void *hva, const U64_t size)</div><div class="ttdoc">This function maps host physical address into hypervisor&#39;s virtual memory. </div><div class="ttdef"><b>Definition:</b> <a href="monitor__util_8c_source.html#l00095">monitor_util.c:95</a></div></div>
<div class="ttc" id="monitor__types_8h_html_a35e867d4f252496befeb6d260a03acac"><div class="ttname"><a href="monitor__types_8h.html#a35e867d4f252496befeb6d260a03acac">HPA_t</a></div><div class="ttdeci">U64_t HPA_t</div><div class="ttdoc">A type definition for a host physical address. Note : The size of this type is architecture-dependent...</div><div class="ttdef"><b>Definition:</b> <a href="monitor__types_8h_source.html#l00054">monitor_types.h:54</a></div></div>
<div class="ttc" id="monitor__util_8c_html_a5c5054946f567612d0ad5878def288f3"><div class="ttname"><a href="monitor__util_8c.html#a5c5054946f567612d0ad5878def288f3">mapHPAintoHVA</a></div><div class="ttdeci">void * mapHPAintoHVA(const HPA_t hpa, const U64_t size)</div><div class="ttdoc">This function maps host physical address into hypervisor&#39;s virtual memory. </div><div class="ttdef"><b>Definition:</b> <a href="monitor__util_8c_source.html#l00084">monitor_util.c:84</a></div></div>
<div class="ttc" id="monitor__ept_8h_html_a3ce3f0ab82d640f2e804b9731ad40372"><div class="ttname"><a href="monitor__ept_8h.html#a3ce3f0ab82d640f2e804b9731ad40372">EPT_PML4_GPA_SHIFT</a></div><div class="ttdeci">#define EPT_PML4_GPA_SHIFT</div><div class="ttdoc">A right-shift value for EPT-PML4 entry address calculation. </div><div class="ttdef"><b>Definition:</b> <a href="monitor__ept_8h_source.html#l00174">monitor_ept.h:174</a></div></div>
<div class="ttc" id="monitor__ept_8h_html_abf806e0ba2ec2f5405e3ef9701d8a737"><div class="ttname"><a href="monitor__ept_8h.html#abf806e0ba2ec2f5405e3ef9701d8a737">EPT_PD_GPA_MASK</a></div><div class="ttdeci">#define EPT_PD_GPA_MASK</div><div class="ttdoc">A mask used to extract HPA of EPT entry from GPA. </div><div class="ttdef"><b>Definition:</b> <a href="monitor__ept_8h_source.html#l00171">monitor_ept.h:171</a></div></div>
<div class="ttc" id="guest__state_8c_html_a33fb594e7472da1af81f2abf272a64b2"><div class="ttname"><a href="guest__state_8c.html#a33fb594e7472da1af81f2abf272a64b2">get_ept_base_HPA</a></div><div class="ttdeci">GPA_t get_ept_base_HPA()</div><div class="ttdoc">Get the start address of extended page table. </div><div class="ttdef"><b>Definition:</b> <a href="guest__state_8c_source.html#l00018">guest_state.c:18</a></div></div>
<div class="ttc" id="monitor__ept_8h_html_ace14d38a20945cb7618b39812883005c"><div class="ttname"><a href="monitor__ept_8h.html#ace14d38a20945cb7618b39812883005c">EPT_PML4_GPA_MASK</a></div><div class="ttdeci">#define EPT_PML4_GPA_MASK</div><div class="ttdoc">A mask used to extract HPA of EPT entry from GPA. </div><div class="ttdef"><b>Definition:</b> <a href="monitor__ept_8h_source.html#l00169">monitor_ept.h:169</a></div></div>
<div class="ttc" id="monitor__types_8h_html_ae2a9c06a03ebe51122eda7315fbeb5b0"><div class="ttname"><a href="monitor__types_8h.html#ae2a9c06a03ebe51122eda7315fbeb5b0">EPT_ENTRY_t</a></div><div class="ttdeci">U64_t EPT_ENTRY_t</div><div class="ttdoc">A type definition for EPT entry. </div><div class="ttdef"><b>Definition:</b> <a href="monitor__types_8h_source.html#l00060">monitor_types.h:60</a></div></div>
<div class="ttc" id="monitor__ept_8h_html_a95ef0343cf64ff4f5c3a519d24d131dc"><div class="ttname"><a href="monitor__ept_8h.html#a95ef0343cf64ff4f5c3a519d24d131dc">EPT_PT_GPA_SHIFT</a></div><div class="ttdeci">#define EPT_PT_GPA_SHIFT</div><div class="ttdoc">A right-shift value for EPT-PT entry address calculation. </div><div class="ttdef"><b>Definition:</b> <a href="monitor__ept_8h_source.html#l00177">monitor_ept.h:177</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="monitor__util_8c_a19ca3fbdba02a8a291fbf56b030e7323_cgraph.png" border="0" usemap="#monitor__util_8c_a19ca3fbdba02a8a291fbf56b030e7323_cgraph" alt=""/></div>
<map name="monitor__util_8c_a19ca3fbdba02a8a291fbf56b030e7323_cgraph" id="monitor__util_8c_a19ca3fbdba02a8a291fbf56b030e7323_cgraph">
<area shape="rect" id="node2" href="guest__state_8c.html#a33fb594e7472da1af81f2abf272a64b2" title="Get the start address of extended page table. " alt="" coords="139,5,274,32"/><area shape="rect" id="node5" href="monitor__util_8c.html#a5c5054946f567612d0ad5878def288f3" title="This function maps host physical address into hypervisor&#39;s virtual memory. " alt="" coords="145,56,268,83"/><area shape="rect" id="node6" href="monitor__util_8c.html#ae5b8234f7d553177a9d3f932fe1c112b" title="This function maps host physical address into hypervisor&#39;s virtual memory. " alt="" coords="139,107,275,133"/><area shape="rect" id="node3" href="vmcs_8h.html#a5c020f2b6689be533301e18f9b9061ae" title="get the value of guest&#39;s EPTP field in the VMCS " alt="" coords="323,5,469,32"/><area shape="rect" id="node4" href="vmcs_8c.html#a38c7d96da94cf9b3fe630936e1c11c0b" title="get a value in the VMCS " alt="" coords="518,5,653,32"/></map>
</div>
</p>

<p><div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="monitor__util_8c_a19ca3fbdba02a8a291fbf56b030e7323_icgraph.png" border="0" usemap="#monitor__util_8c_a19ca3fbdba02a8a291fbf56b030e7323_icgraph" alt=""/></div>
<map name="monitor__util_8c_a19ca3fbdba02a8a291fbf56b030e7323_icgraph" id="monitor__util_8c_a19ca3fbdba02a8a291fbf56b030e7323_icgraph">
<area shape="rect" id="node2" href="guest___i_a32e_page_8h.html#af233f3d87b0a388e0c534d928167e20a" title="Traverse all pages based on IA32e paging mode. It traverse at PML4 level. " alt="" coords="670,42,807,69"/><area shape="rect" id="node6" href="guest___i_a32e_page_8h.html#acc5be7aa7fcf4568891e6620f0b94141" title="Traverse all pages based on IA32e paging mode. It traverse at page directory pointer (PDP) level..." alt="" coords="486,42,621,69"/><area shape="rect" id="node7" href="guest___i_a32e_page_8h.html#a7253467a3aa5a9560748b75c4b7c57d5" title="Traverse all pages based on IA32e paging mode. It traverse at page directory (PD) level..." alt="" coords="308,67,433,94"/><area shape="rect" id="node8" href="guest___i_a32e_page_8h.html#ab5dc18fd91ff94f88a941b35972f43ad" title="Traverse all pages based on IA32e paging mode. It traverse at page table (PT) level. " alt="" coords="139,118,255,145"/><area shape="rect" id="node9" href="memory__ownership__table_8c.html#a3266b049b47ff6ab74a67cf35aa4147c" title="change a page&#39;s status " alt="" coords="305,143,437,170"/><area shape="rect" id="node11" href="unit__test_8c.html#a9a5ea09666782de7674e77cb9211aa9f" title="A testing function for gpaToHPA. " alt="" coords="141,219,254,246"/><area shape="rect" id="node3" href="guest__state_8h.html#a3d8f41db587aed7fce30c4edcd4aaaf6" title="Traverse all pages that start from startGPAofPageTable and do something for each page. " alt="" coords="856,49,995,75"/><area shape="rect" id="node4" href="memory__ownership__table_8c.html#aa0e8340e3e2dc314a25b0c93fdfd54ab" title="Start to protect of currently running process&#39;s pages. " alt="" coords="1043,77,1211,103"/><area shape="rect" id="node5" href="event_handler_8h.html#a89bbf08a67ab2dc3c540ee1cb1904535" title="This function handles hypercall invoked from guest application. The goal of this function is to start..." alt="" coords="1259,77,1381,103"/><area shape="rect" id="node10" href="memory__ownership__table_8c.html#af13e8ca1a88180df93e4af4db30e3244" title="Set the a frame to closed state. " alt="" coords="512,111,595,138"/><area shape="rect" id="node12" href="unit__test_8c.html#a4b454bbf54829d209850a8efa639b942" title="A function to start unit test. " alt="" coords="332,219,409,246"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5c5054946f567612d0ad5878def288f3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void* mapHPAintoHVA </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="monitor__types_8h.html#a35e867d4f252496befeb6d260a03acac">HPA_t</a>&#160;</td>
          <td class="paramname"><em>hpa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="monitor__types_8h.html#a822913f05423d4a8faac6dfec8bc1617">U64_t</a>&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function maps host physical address into hypervisor's virtual memory. </p>
<dl class="section return"><dt>반환값</dt><dd>This function returns mapped host virtual memory</dd></dl>
<p>Details. {mapHPAintoHVA}</p>
<p>This function is used to convert host physical address to host virtual address. During converting, depending on the base hypervisor solution, the HVA may be newly allocated. In this case, this function allocats new virtual address by invoking <b>HYPERVISOR_DEPENDENT ALLOCATION FUNCTION</b>.<br/>
</p>
<dl class="section note"><dt>주의</dt><dd>In this implementation that uses Bitvisor, mapmem_hphys() Bitvisor function is used to allocate new virtual memory. Therefore, this <b>MUST BE UNALLOCATED</b> after usage by invoking <a class="el" href="monitor__util_8c.html#a5c5054946f567612d0ad5878def288f3">unmapHPAintoHVA</a> function </dd></dl>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hpa</td><td>Host physical address to map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>The size of the virtual memory to be allocated. </td></tr>
  </table>
  </dd>
</dl>

<p><a class="el" href="monitor__util_8c_source.html">monitor_util.c</a> 파일의 <a class="el" href="monitor__util_8c_source.html#l00084">84</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;{</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">    #ifdef CONFIG_BITVISOR</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">void</span> *hva = 0;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    hva = mapmem_hphys (hpa, size, 0);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">return</span> hva;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">    #else</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor"></span>}</div>
</div><!-- fragment -->
<p><div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="monitor__util_8c_a5c5054946f567612d0ad5878def288f3_icgraph.png" border="0" usemap="#monitor__util_8c_a5c5054946f567612d0ad5878def288f3_icgraph" alt=""/></div>
<map name="monitor__util_8c_a5c5054946f567612d0ad5878def288f3_icgraph" id="monitor__util_8c_a5c5054946f567612d0ad5878def288f3_icgraph">
<area shape="rect" id="node2" href="guest___i_a32e_page_8h.html#af233f3d87b0a388e0c534d928167e20a" title="Traverse all pages based on IA32e paging mode. It traverse at PML4 level. " alt="" coords="841,296,978,323"/><area shape="rect" id="node6" href="guest___i_a32e_page_8h.html#acc5be7aa7fcf4568891e6620f0b94141" title="Traverse all pages based on IA32e paging mode. It traverse at page directory pointer (PDP) level..." alt="" coords="657,207,791,233"/><area shape="rect" id="node7" href="guest___i_a32e_page_8h.html#a7253467a3aa5a9560748b75c4b7c57d5" title="Traverse all pages based on IA32e paging mode. It traverse at page directory (PD) level..." alt="" coords="479,169,604,196"/><area shape="rect" id="node8" href="guest___i_a32e_page_8h.html#ab5dc18fd91ff94f88a941b35972f43ad" title="Traverse all pages based on IA32e paging mode. It traverse at page table (PT) level. " alt="" coords="310,144,426,171"/><area shape="rect" id="node9" href="monitor__util_8c.html#a19ca3fbdba02a8a291fbf56b030e7323" title="This function converts guest physical address to host physical address. " alt="" coords="177,245,261,272"/><area shape="rect" id="node3" href="guest__state_8h.html#a3d8f41db587aed7fce30c4edcd4aaaf6" title="Traverse all pages that start from startGPAofPageTable and do something for each page. " alt="" coords="1027,296,1165,323"/><area shape="rect" id="node4" href="memory__ownership__table_8c.html#aa0e8340e3e2dc314a25b0c93fdfd54ab" title="Start to protect of currently running process&#39;s pages. " alt="" coords="1213,321,1381,348"/><area shape="rect" id="node5" href="event_handler_8h.html#a89bbf08a67ab2dc3c540ee1cb1904535" title="This function handles hypercall invoked from guest application. The goal of this function is to start..." alt="" coords="1429,321,1552,348"/><area shape="rect" id="node10" href="memory__ownership__table_8c.html#a3266b049b47ff6ab74a67cf35aa4147c" title="change a page&#39;s status " alt="" coords="475,347,607,373"/><area shape="rect" id="node12" href="unit__test_8c.html#a9a5ea09666782de7674e77cb9211aa9f" title="A testing function for gpaToHPA. " alt="" coords="311,397,425,424"/><area shape="rect" id="node11" href="memory__ownership__table_8c.html#af13e8ca1a88180df93e4af4db30e3244" title="Set the a frame to closed state. " alt="" coords="683,347,765,373"/><area shape="rect" id="node13" href="unit__test_8c.html#a4b454bbf54829d209850a8efa639b942" title="A function to start unit test. " alt="" coords="503,397,580,424"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae5b8234f7d553177a9d3f932fe1c112b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void unmapHPAintoHVA </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>hva</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="monitor__types_8h.html#a822913f05423d4a8faac6dfec8bc1617">U64_t</a>&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function maps host physical address into hypervisor's virtual memory. </p>
<p>Details. {unmapHPAintoHVA}</p>
<p>Depending on the implementation of <a class="el" href="monitor__util_8c.html#a5c5054946f567612d0ad5878def288f3">mapHPAintoHVA</a> function, a mapped virtual memory should be deallocated after its use. This function exist for this purpose. </p>
<dl class="section note"><dt>주의</dt><dd>In this implmentation that uses Bitvisor, mapmem_hphys() Bitvisor function is used to deallocate the virtual memory. </dd></dl>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hva</td><td>Host virtual address to unmap </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>The size of the allocated virtual memory speficied in the <a class="el" href="monitor__util_8c.html#a5c5054946f567612d0ad5878def288f3">mapHPAintoHVA</a> function. </td></tr>
  </table>
  </dd>
</dl>

<p><a class="el" href="monitor__util_8c_source.html">monitor_util.c</a> 파일의 <a class="el" href="monitor__util_8c_source.html#l00095">95</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;{</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor">    #ifdef CONFIG_BITVISOR</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor"></span>        unmapmem (hva, size);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="preprocessor">    #else</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor"></span>        <span class="comment">//Noop</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor">}</div><!-- fragment -->
<p><div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="monitor__util_8c_ae5b8234f7d553177a9d3f932fe1c112b_icgraph.png" border="0" usemap="#monitor__util_8c_ae5b8234f7d553177a9d3f932fe1c112b_icgraph" alt=""/></div>
<map name="monitor__util_8c_ae5b8234f7d553177a9d3f932fe1c112b_icgraph" id="monitor__util_8c_ae5b8234f7d553177a9d3f932fe1c112b_icgraph">
<area shape="rect" id="node2" href="guest___i_a32e_page_8h.html#af233f3d87b0a388e0c534d928167e20a" title="Traverse all pages based on IA32e paging mode. It traverse at PML4 level. " alt="" coords="854,296,991,323"/><area shape="rect" id="node6" href="guest___i_a32e_page_8h.html#acc5be7aa7fcf4568891e6620f0b94141" title="Traverse all pages based on IA32e paging mode. It traverse at page directory pointer (PDP) level..." alt="" coords="670,207,805,233"/><area shape="rect" id="node7" href="guest___i_a32e_page_8h.html#a7253467a3aa5a9560748b75c4b7c57d5" title="Traverse all pages based on IA32e paging mode. It traverse at page directory (PD) level..." alt="" coords="492,169,617,196"/><area shape="rect" id="node8" href="guest___i_a32e_page_8h.html#ab5dc18fd91ff94f88a941b35972f43ad" title="Traverse all pages based on IA32e paging mode. It traverse at page table (PT) level. " alt="" coords="323,144,439,171"/><area shape="rect" id="node9" href="monitor__util_8c.html#a19ca3fbdba02a8a291fbf56b030e7323" title="This function converts guest physical address to host physical address. " alt="" coords="190,245,274,272"/><area shape="rect" id="node3" href="guest__state_8h.html#a3d8f41db587aed7fce30c4edcd4aaaf6" title="Traverse all pages that start from startGPAofPageTable and do something for each page. " alt="" coords="1040,296,1179,323"/><area shape="rect" id="node4" href="memory__ownership__table_8c.html#aa0e8340e3e2dc314a25b0c93fdfd54ab" title="Start to protect of currently running process&#39;s pages. " alt="" coords="1227,321,1395,348"/><area shape="rect" id="node5" href="event_handler_8h.html#a89bbf08a67ab2dc3c540ee1cb1904535" title="This function handles hypercall invoked from guest application. The goal of this function is to start..." alt="" coords="1443,321,1565,348"/><area shape="rect" id="node10" href="memory__ownership__table_8c.html#a3266b049b47ff6ab74a67cf35aa4147c" title="change a page&#39;s status " alt="" coords="489,347,621,373"/><area shape="rect" id="node12" href="unit__test_8c.html#a9a5ea09666782de7674e77cb9211aa9f" title="A testing function for gpaToHPA. " alt="" coords="325,397,438,424"/><area shape="rect" id="node11" href="memory__ownership__table_8c.html#af13e8ca1a88180df93e4af4db30e3244" title="Set the a frame to closed state. " alt="" coords="696,347,779,373"/><area shape="rect" id="node13" href="unit__test_8c.html#a4b454bbf54829d209850a8efa639b942" title="A function to start unit test. " alt="" coords="516,397,593,424"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
생성시간 : 금 3월 14 2014 15:41:32, 프로젝트명 : Security Monitor, 생성자 :  &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
