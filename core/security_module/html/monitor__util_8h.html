<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Security Monitor: include/monitor_util.h 파일 참조</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Security Monitor
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- 다음에 의해 생성됨 :  Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'검색');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>메인&#160;페이지</span></a></li>
      <li><a href="annotated.html"><span>데이타&#160;구조</span></a></li>
      <li class="current"><a href="files.html"><span>파일들</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="검색" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>파일&#160;목록</span></a></li>
      <li><a href="globals.html"><span>전역</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">함수</a>  </div>
  <div class="headertitle">
<div class="title">include/monitor_util.h 파일 참조</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file exists for supporting some uiility functions.  
<a href="#details">더 자세히 ...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="monitor__types_8h_source.html">monitor_types.h</a>&gt;</code><br/>
</div><div class="textblock"><div class="dynheader">
monitor_util.h에 대한 include 의존 그래프</div>
<div class="dyncontent">
<div class="center"><img src="monitor__util_8h__incl.png" border="0" usemap="#include_2monitor__util_8h" alt=""/></div>
<map name="include_2monitor__util_8h" id="include_2monitor__util_8h">
<area shape="rect" id="node3" href="monitor__types_8h.html" title="Definitions of types that are used in this project." alt="" coords="20,83,135,112"/></map>
</div>
</div><div class="textblock"><div class="dynheader">
이 그래프는 이 파일을 직/간접적으로 include 하는 파일들을 보여줍니다.:</div>
<div class="dyncontent">
<div class="center"><img src="monitor__util_8h__dep__incl.png" border="0" usemap="#include_2monitor__util_8hdep" alt=""/></div>
<map name="include_2monitor__util_8hdep" id="include_2monitor__util_8hdep">
<area shape="rect" id="node3" href="guest___i_a32e_page_8c.html" title="defines functions that are related to IA32e paging mode (for guest)" alt="" coords="5,83,141,112"/><area shape="rect" id="node5" href="memory__ownership__table_8c.html" title="Definition of data structrues &amp; functions for memory ownership table. ." alt="" coords="165,83,347,112"/><area shape="rect" id="node7" href="monitor__util_8c.html" title="This file includes some implementations of some utility functions." alt="" coords="371,83,469,112"/><area shape="rect" id="node9" href="unit__test_8c.html" title="This file is used for unit test of functions in the security monitor." alt="" coords="493,83,576,112"/></map>
</div>
</div>
<p><a href="monitor__util_8h_source.html">이 파일의 소스 코드 페이지로 가기</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
함수</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monitor__util_8h.html#ac66e271532851a5737a7968ddc1390e4">mapHPAintoHVA</a> (const <a class="el" href="monitor__types_8h.html#a35e867d4f252496befeb6d260a03acac">HPA_t</a> hpa, const <a class="el" href="monitor__types_8h.html#a822913f05423d4a8faac6dfec8bc1617">U64_t</a> size)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This function maps host physical address into hypervisor's virtual memory.  <a href="#ac66e271532851a5737a7968ddc1390e4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monitor__util_8h.html#ae5b8234f7d553177a9d3f932fe1c112b">unmapHPAintoHVA</a> (void *hva, const <a class="el" href="monitor__types_8h.html#a822913f05423d4a8faac6dfec8bc1617">U64_t</a> size)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This function maps host physical address into hypervisor's virtual memory.  <a href="#ae5b8234f7d553177a9d3f932fe1c112b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="monitor__types_8h.html#a35e867d4f252496befeb6d260a03acac">HPA_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monitor__util_8h.html#a19ca3fbdba02a8a291fbf56b030e7323">gpaToHPA</a> (const <a class="el" href="monitor__types_8h.html#a25ec30a201a5e2d4bdd7b40a89014d5c">GPA_t</a> gpa, <a class="el" href="monitor__types_8h.html#a35e867d4f252496befeb6d260a03acac">HPA_t</a> *eptEntryHPA)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This function converts guest physical address to host physical address.  <a href="#a19ca3fbdba02a8a291fbf56b030e7323"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>상세한 설명</h2>
<div class="textblock"><p>This file exists for supporting some uiility functions. </p>

<p><a class="el" href="monitor__util_8h_source.html">monitor_util.h</a> 파일에서 정의되었습니다.</p>
</div><hr/><h2>함수 문서화</h2>
<a class="anchor" id="a19ca3fbdba02a8a291fbf56b030e7323"></a><!-- doxytag: member="monitor_util.h::gpaToHPA" ref="a19ca3fbdba02a8a291fbf56b030e7323" args="(const GPA_t gpa, HPA_t *eptEntryHPA)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="monitor__types_8h.html#a35e867d4f252496befeb6d260a03acac">HPA_t</a> <a class="el" href="monitor__util_8c.html#a19ca3fbdba02a8a291fbf56b030e7323">gpaToHPA</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="monitor__types_8h.html#a25ec30a201a5e2d4bdd7b40a89014d5c">GPA_t</a>&#160;</td>
          <td class="paramname"><em>gpa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="monitor__types_8h.html#a35e867d4f252496befeb6d260a03acac">HPA_t</a> *&#160;</td>
          <td class="paramname"><em>eptEntryHPA</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This function converts guest physical address to host physical address. </p>
<dl class="return"><dt><b>반환값:</b></dt><dd>This function returns converted HPA, and HPA of EPT entry of returned HPA.</dd></dl>
<p>Detail.</p>
<p>This function converts guest physical address (GPA) to host physical address (HPA).<br/>
 To do this, this function traverses the current guest's page table from PML4 to page table.<br/>
 And, it also returns HPA of EPT entry of converted HPA.<br/>
 For more information, see __Intel's Architecture Manual Vol. 3, Chapter 28.2.2 : EPT Tranlation Mechanism__. </p>
<dl class="params"><dt><b>매개변수:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">gpa</td><td>Guest physical address to convert </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">eptEntryHPA</td><td>HPA of EPT entry of the returned HPA </td></tr>
  </table>
  </dd>
</dl>

<p><a class="el" href="memoryownershiptable_8c_source.html">memoryownershiptable.c</a> 파일의 <a class="el" href="memoryownershiptable_8c_source.html#l00144">144</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><pre class="fragment">{
    PHYADDR_t eptPML4BasePhysicalAddress;
    PHYADDR_t eptPML4EntryPhysicalAddress;
    VIRTADDR_t *eptPML4EntryVirtualAddress;
    <a class="code" href="monitor__types_8h.html#a822913f05423d4a8faac6dfec8bc1617" title="A type definition for a unsigned 64-bits data.">U64_t</a>   selectedEPTPML4Entry;

    PHYADDR_t eptPDPTBasePhysicalAddress;
    PHYADDR_t eptPDPTEntryPhysicalAddress;
    VIRTADDR_t *eptPDPTEntryVirtualAddress;
    <a class="code" href="monitor__types_8h.html#a822913f05423d4a8faac6dfec8bc1617" title="A type definition for a unsigned 64-bits data.">U64_t</a> selectedEPTPDPTEntry;

    PHYADDR_t eptPDBasePhysicalAddress;
    PHYADDR_t eptPDEntryPhysicalAddress;
    VIRTADDR_t *eptPDEntryVirtualAddress;
    <a class="code" href="monitor__types_8h.html#a822913f05423d4a8faac6dfec8bc1617" title="A type definition for a unsigned 64-bits data.">U64_t</a> selectedEPTPDEntry;

    PHYADDR_t eptPTBasePhysicalAddress;
    PHYADDR_t eptPTEntryPhysicalAddress;
    VIRTADDR_t *eptPTEntryVirtualAddress;
    <a class="code" href="monitor__types_8h.html#a822913f05423d4a8faac6dfec8bc1617" title="A type definition for a unsigned 64-bits data.">U64_t</a> selectedEPTPTEntry;

    PHYADDR_t hpa = 0;
    <span class="comment">//Traverse EPT PML</span>
    sec_getEPTPhyAddr(&amp;eptPML4BasePhysicalAddress);
    eptPML4EntryPhysicalAddress = (eptPML4BasePhysicalAddress | (((gpa &amp; <a class="code" href="monitor__ept_8h.html#ace14d38a20945cb7618b39812883005c" title="A mask used to extract HPA of EPT entry from GPA.">EPT_PML4_GPA_MASK</a>) &gt;&gt; <a class="code" href="monitor__ept_8h.html#a3ce3f0ab82d640f2e804b9731ad40372" title="A right-shift value for EPT-PML4 entry address calculation.">EPT_PML4_GPA_SHIFT</a>) &lt;&lt; PML4_SHIFT));
    eptPML4EntryVirtualAddress =  mapHPAIntoHVA(eptPML4EntryPhysicalAddress,<span class="keyword">sizeof</span>(<a class="code" href="monitor__types_8h.html#a822913f05423d4a8faac6dfec8bc1617" title="A type definition for a unsigned 64-bits data.">U64_t</a>));<span class="comment">//getVirtualAddressFromPhysiacalAddress(eptPML4EntryPhysicalAddress);</span>
    selectedEPTPML4Entry = *eptPML4EntryVirtualAddress;
    unmapHPAFromHVA(eptPML4EntryVirtualAddress,<span class="keyword">sizeof</span>(<a class="code" href="monitor__types_8h.html#a822913f05423d4a8faac6dfec8bc1617" title="A type definition for a unsigned 64-bits data.">U64_t</a>));
    <span class="keywordflow">if</span>(!selectedEPTPML4Entry)
    {
        <span class="keywordflow">return</span> 0;
    }


    
    <span class="comment">//Traverse EPT PDPT</span>
    eptPDPTBasePhysicalAddress = selectedEPTPML4Entry &amp; PAGE_DIRECTORY_POINTER_TABLE_ENTRY_MASK;
    eptPDPTEntryPhysicalAddress = (eptPDPTBasePhysicalAddress | (((gpa &amp; EPT_PDPT_GPA_MASK) &gt;&gt; EPT_PDPT_GPA_SHIFT) &lt;&lt; PDPT_SHIFT));
    eptPDPTEntryVirtualAddress =  mapHPAIntoHVA(eptPDPTEntryPhysicalAddress,<span class="keyword">sizeof</span>(<a class="code" href="monitor__types_8h.html#a822913f05423d4a8faac6dfec8bc1617" title="A type definition for a unsigned 64-bits data.">U64_t</a>));<span class="comment">//getVirtualAddressFromPhysiacalAddress(eptPDPTEntryPhysicalAddress);</span>
    selectedEPTPDPTEntry = *eptPDPTEntryVirtualAddress;
    unmapHPAFromHVA(eptPDPTEntryVirtualAddress,<span class="keyword">sizeof</span>(<a class="code" href="monitor__types_8h.html#a822913f05423d4a8faac6dfec8bc1617" title="A type definition for a unsigned 64-bits data.">U64_t</a>));
    <span class="keywordflow">if</span>(!selectedEPTPDPTEntry)
    {
        <span class="keywordflow">return</span> 0;
    }
    
    <span class="comment">//Traverse EPT PD</span>
    eptPDBasePhysicalAddress = selectedEPTPDPTEntry &amp; PAGE_DIECTORY_ENTRY_MASK;
    eptPDEntryPhysicalAddress = (eptPDBasePhysicalAddress | (((gpa &amp; <a class="code" href="monitor__ept_8h.html#abf806e0ba2ec2f5405e3ef9701d8a737" title="A mask used to extract HPA of EPT entry from GPA.">EPT_PD_GPA_MASK</a>) &gt;&gt; <a class="code" href="monitor__ept_8h.html#aa06a29042c653e73fca00adc8fd7d663" title="A right-shift value for EPT-PD entry address calculation.">EPT_PD_GPA_SHIFT</a>) &lt;&lt; PD_SHIFT));
    eptPDEntryVirtualAddress =  mapHPAIntoHVA(eptPDEntryPhysicalAddress,<span class="keyword">sizeof</span>(<a class="code" href="monitor__types_8h.html#a822913f05423d4a8faac6dfec8bc1617" title="A type definition for a unsigned 64-bits data.">U64_t</a>));<span class="comment">//getVirtualAddressFromPhysiacalAddress(eptPDEntryPhysicalAddress);</span>
    selectedEPTPDEntry = *eptPDEntryVirtualAddress;
    unmapHPAFromHVA(eptPDEntryVirtualAddress,<span class="keyword">sizeof</span>(<a class="code" href="monitor__types_8h.html#a822913f05423d4a8faac6dfec8bc1617" title="A type definition for a unsigned 64-bits data.">U64_t</a>));
    <span class="keywordflow">if</span>(!selectedEPTPDEntry)
    {
        <span class="keywordflow">return</span> 0;
    }   
    
    <span class="comment">//Traverse EPT PT</span>
    eptPTBasePhysicalAddress = selectedEPTPDEntry &amp; PAGE_TABLE_ENTRY_MASK;
    eptPTEntryPhysicalAddress = (eptPTBasePhysicalAddress | (((gpa &amp; <a class="code" href="monitor__ept_8h.html#a6f24b0fd49793bb5746899f709fbf171" title="A mask used to extract HPA of EPT entry from GPA.">EPT_PT_GPA_MASK</a>) &gt;&gt; <a class="code" href="monitor__ept_8h.html#a95ef0343cf64ff4f5c3a519d24d131dc" title="A right-shift value for EPT-PT entry address calculation.">EPT_PT_GPA_SHIFT</a>) &lt;&lt; PT_SHIFT));
    eptPTEntryVirtualAddress =  mapHPAIntoHVA(eptPTEntryPhysicalAddress,<span class="keyword">sizeof</span>(<a class="code" href="monitor__types_8h.html#a822913f05423d4a8faac6dfec8bc1617" title="A type definition for a unsigned 64-bits data.">U64_t</a>));<span class="comment">//getVirtualAddressFromPhysiacalAddress(eptPTEntryPhysicalAddress); </span>
    selectedEPTPTEntry = *eptPTEntryVirtualAddress;
    <span class="keywordflow">if</span>(pageTableEntryPhysicalAddress)
    {
        *pageTableEntryPhysicalAddress = eptPTEntryPhysicalAddress;
    }
    unmapHPAFromHVA(eptPTEntryVirtualAddress,<span class="keyword">sizeof</span>(<a class="code" href="monitor__types_8h.html#a822913f05423d4a8faac6dfec8bc1617" title="A type definition for a unsigned 64-bits data.">U64_t</a>));            
    <span class="keywordflow">if</span>(!selectedEPTPTEntry)
    {
        <span class="keywordflow">return</span> 0;
    }
    
    <span class="comment">//Calculate final HPA</span>
    hpa = ((selectedEPTPTEntry &amp; PAGE_MASK) | (gpa &amp; <a class="code" href="monitor__ept_8h.html#a666c4ed20e984021f4fd95a52bd2144f" title="A mask used to extract HPA of EPT entry from GPA.">EPT_GPA_MASK</a>));
    
    <span class="keywordflow">return</span> hpa;
}
</pre></div>
<p><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="monitor__util_8h_a19ca3fbdba02a8a291fbf56b030e7323_cgraph.png" border="0" usemap="#monitor__util_8h_a19ca3fbdba02a8a291fbf56b030e7323_cgraph" alt=""/></div>
<map name="monitor__util_8h_a19ca3fbdba02a8a291fbf56b030e7323_cgraph" id="monitor__util_8h_a19ca3fbdba02a8a291fbf56b030e7323_cgraph">
<area shape="rect" id="node4" href="guest__state_8c.html#a33fb594e7472da1af81f2abf272a64b2" title="Get the start address of extended page table." alt="" coords="144,5,277,35"/><area shape="rect" id="node10" href="monitor__util_8h.html#ac66e271532851a5737a7968ddc1390e4" title="This function maps host physical address into hypervisor&#39;s virtual memory." alt="" coords="149,59,272,88"/><area shape="rect" id="node12" href="monitor__util_8h.html#ae5b8234f7d553177a9d3f932fe1c112b" title="This function maps host physical address into hypervisor&#39;s virtual memory." alt="" coords="141,112,280,141"/><area shape="rect" id="node6" href="vmcs_8h.html#a5c020f2b6689be533301e18f9b9061ae" title="get the value of guest&#39;s EPTP field in the VMCS" alt="" coords="328,5,477,35"/><area shape="rect" id="node8" href="vmcs_8h.html#a38c7d96da94cf9b3fe630936e1c11c0b" title="get a value in the VMCS" alt="" coords="525,5,661,35"/></map>
</div>
</p>

<p><div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="monitor__util_8h_a19ca3fbdba02a8a291fbf56b030e7323_icgraph.png" border="0" usemap="#monitor__util_8h_a19ca3fbdba02a8a291fbf56b030e7323_icgraph" alt=""/></div>
<map name="monitor__util_8h_a19ca3fbdba02a8a291fbf56b030e7323_icgraph" id="monitor__util_8h_a19ca3fbdba02a8a291fbf56b030e7323_icgraph">
<area shape="rect" id="node3" href="guest___i_a32e_page_8h.html#af233f3d87b0a388e0c534d928167e20a" title="Traverse all pages based on IA32e paging mode. It traverse at PML4 level." alt="" coords="689,49,828,78"/><area shape="rect" id="node11" href="guest___i_a32e_page_8h.html#acc5be7aa7fcf4568891e6620f0b94141" title="Traverse all pages based on IA32e paging mode. It traverse at page directory pointer (PDP) level..." alt="" coords="501,49,640,78"/><area shape="rect" id="node14" href="guest___i_a32e_page_8h.html#a7253467a3aa5a9560748b75c4b7c57d5" title="Traverse all pages based on IA32e paging mode. It traverse at page directory (PD) level..." alt="" coords="323,74,453,103"/><area shape="rect" id="node17" href="guest___i_a32e_page_8h.html#ab5dc18fd91ff94f88a941b35972f43ad" title="Traverse all pages based on IA32e paging mode. It traverse at page table (PT) level." alt="" coords="148,125,268,154"/><area shape="rect" id="node20" href="memory__ownership__table_8c.html#af13e8ca1a88180df93e4af4db30e3244" title="Set the a frame to closed state." alt="" coords="347,177,429,206"/><area shape="rect" id="node23" href="memory__ownership__table_8c.html#abf5fe4889dc29561c6131dc40c59fc61" title="change a page&#39;s status" alt="" coords="143,229,273,258"/><area shape="rect" id="node27" href="unit__test_8c.html#a9a5ea09666782de7674e77cb9211aa9f" title="A testing function for [gpaToHPA](gpaToHPA)" alt="" coords="151,282,265,311"/><area shape="rect" id="node5" href="guest__state_8h.html#a3d8f41db587aed7fce30c4edcd4aaaf6" title="Traverse all pages that start from startGPAofPageTable and do something for each page." alt="" coords="877,62,1019,91"/><area shape="rect" id="node7" href="memory__ownership__table_8c.html#aa0e8340e3e2dc314a25b0c93fdfd54ab" title="Start to protect of currently running process&#39;s pages." alt="" coords="1068,94,1236,123"/><area shape="rect" id="node9" href="event_handler_8h.html#a89bbf08a67ab2dc3c540ee1cb1904535" title="This function handles hypercall invoked from guest application. &#160;The goal of this function is to star..." alt="" coords="1285,94,1408,123"/><area shape="rect" id="node29" href="unit__test_8c.html#a4b454bbf54829d209850a8efa639b942" title="A function to start unit test." alt="" coords="349,282,427,311"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac66e271532851a5737a7968ddc1390e4"></a><!-- doxytag: member="monitor_util.h::mapHPAintoHVA" ref="ac66e271532851a5737a7968ddc1390e4" args="(const HPA_t hpa, const U64_t size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * <a class="el" href="monitor__util_8c.html#a5c5054946f567612d0ad5878def288f3">mapHPAintoHVA</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="monitor__types_8h.html#a35e867d4f252496befeb6d260a03acac">HPA_t</a>&#160;</td>
          <td class="paramname"><em>hpa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="monitor__types_8h.html#a822913f05423d4a8faac6dfec8bc1617">U64_t</a>&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This function maps host physical address into hypervisor's virtual memory. </p>
<dl class="return"><dt><b>반환값:</b></dt><dd>This function returns mapped host virtual memory</dd></dl>
<p>Details. {mapHPAintoHVA}</p>
<p>This function is used to convert host physical address to host virtual address. During converting, depending on the base hypervisor solution, the HVA may be newly allocated. In this case, this function allocats new virtual address by invoking __HYPERVISOR_DEPENDENT ALLOCATION FUNCTION__.<br/>
 </p>
<dl class="note"><dt><b>주의:</b></dt><dd>In this implementation that uses Bitvisor, mapmem_hphys() Bitvisor function is used to allocate new virtual memory. Therefore, this __MUST BE UNALLOCATED__ after usage by invoking [unmapHPAintoHVA] (<a class="el" href="monitor__util_8c.html#a5c5054946f567612d0ad5878def288f3">mapHPAintoHVA</a>) function </dd></dl>
<dl class="params"><dt><b>매개변수:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hpa</td><td>Host physical address to map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>The size of the virtual memory to be allocated. </td></tr>
  </table>
  </dd>
</dl>

<p><a class="el" href="monitor__util_8c_source.html">monitor_util.c</a> 파일의 <a class="el" href="monitor__util_8c_source.html#l00105">105</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><pre class="fragment">{
<span class="preprocessor">    #ifdef CONFIG_BITVISOR</span>
<span class="preprocessor"></span>    <span class="keywordtype">void</span> *hva = 0;
    <span class="keywordflow">while</span>(!hva)
    {
        hva = mapmem_hphys (hpa, size, 0);
    }
    <span class="keywordflow">return</span> hva;
<span class="preprocessor">    #else</span>
<span class="preprocessor"></span>        <span class="keywordflow">return</span> 0;
<span class="preprocessor">    #endif</span>
<span class="preprocessor"></span>}
</pre></div>
<p><div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="monitor__util_8h_ac66e271532851a5737a7968ddc1390e4_icgraph.png" border="0" usemap="#monitor__util_8h_ac66e271532851a5737a7968ddc1390e4_icgraph" alt=""/></div>
<map name="monitor__util_8h_ac66e271532851a5737a7968ddc1390e4_icgraph" id="monitor__util_8h_ac66e271532851a5737a7968ddc1390e4_icgraph">
<area shape="rect" id="node3" href="guest___i_a32e_page_8h.html#af233f3d87b0a388e0c534d928167e20a" title="Traverse all pages based on IA32e paging mode. It traverse at PML4 level." alt="" coords="999,220,1137,249"/><area shape="rect" id="node11" href="guest___i_a32e_page_8h.html#acc5be7aa7fcf4568891e6620f0b94141" title="Traverse all pages based on IA32e paging mode. It traverse at page directory pointer (PDP) level..." alt="" coords="811,220,949,249"/><area shape="rect" id="node14" href="guest___i_a32e_page_8h.html#a7253467a3aa5a9560748b75c4b7c57d5" title="Traverse all pages based on IA32e paging mode. It traverse at page directory (PD) level..." alt="" coords="632,245,763,275"/><area shape="rect" id="node17" href="guest___i_a32e_page_8h.html#ab5dc18fd91ff94f88a941b35972f43ad" title="Traverse all pages based on IA32e paging mode. It traverse at page table (PT) level." alt="" coords="457,296,577,325"/><area shape="rect" id="node20" href="memory__ownership__table_8c.html#af13e8ca1a88180df93e4af4db30e3244" title="Set the a frame to closed state." alt="" coords="656,605,739,635"/><area shape="rect" id="node23" href="memory__ownership__table_8c.html#abf5fe4889dc29561c6131dc40c59fc61" title="change a page&#39;s status" alt="" coords="452,605,583,635"/><area shape="rect" id="node26" href="monitor__util_8c.html#a19ca3fbdba02a8a291fbf56b030e7323" title="This function converts guest physical address to host physical address." alt="" coords="180,345,265,375"/><area shape="rect" id="node5" href="guest__state_8h.html#a3d8f41db587aed7fce30c4edcd4aaaf6" title="Traverse all pages that start from startGPAofPageTable and do something for each page." alt="" coords="1187,387,1328,416"/><area shape="rect" id="node7" href="memory__ownership__table_8c.html#aa0e8340e3e2dc314a25b0c93fdfd54ab" title="Start to protect of currently running process&#39;s pages." alt="" coords="1377,483,1545,512"/><area shape="rect" id="node9" href="event_handler_8h.html#a89bbf08a67ab2dc3c540ee1cb1904535" title="This function handles hypercall invoked from guest application. &#160;The goal of this function is to star..." alt="" coords="1595,483,1717,512"/><area shape="rect" id="node34" href="monitor__util_8h.html#a19ca3fbdba02a8a291fbf56b030e7323" title="This function converts guest physical address to host physical address." alt="" coords="316,472,401,501"/><area shape="rect" id="node43" href="unit__test_8c.html#a9a5ea09666782de7674e77cb9211aa9f" title="A testing function for [gpaToHPA](gpaToHPA)" alt="" coords="460,349,575,379"/><area shape="rect" id="node45" href="unit__test_8c.html#a4b454bbf54829d209850a8efa639b942" title="A function to start unit test." alt="" coords="659,349,736,379"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae5b8234f7d553177a9d3f932fe1c112b"></a><!-- doxytag: member="monitor_util.h::unmapHPAintoHVA" ref="ae5b8234f7d553177a9d3f932fe1c112b" args="(void *hva, const U64_t size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="monitor__util_8c.html#ae5b8234f7d553177a9d3f932fe1c112b">unmapHPAintoHVA</a> </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>hva</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="monitor__types_8h.html#a822913f05423d4a8faac6dfec8bc1617">U64_t</a>&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This function maps host physical address into hypervisor's virtual memory. </p>
<p>Details. {unmapHPAintoHVA}</p>
<p>Depending on the implementation of [mapHPAintoHVA](<a class="el" href="monitor__util_8c.html#a5c5054946f567612d0ad5878def288f3">mapHPAintoHVA</a>) function, a mapped virtual memory should be deallocated after its use. This function exist for this purpose. </p>
<dl class="note"><dt><b>주의:</b></dt><dd>In this implmentation that uses Bitvisor, mapmem_hphys() Bitvisor function is used to deallocate the virtual memory. </dd></dl>
<dl class="params"><dt><b>매개변수:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hva</td><td>Host virtual address to unmap </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>The size of the allocated virtual memory speficied in the [mapHPAintoHVA](<a class="el" href="monitor__util_8c.html#a5c5054946f567612d0ad5878def288f3">mapHPAintoHVA</a>) function. </td></tr>
  </table>
  </dd>
</dl>

<p><a class="el" href="monitor__util_8c_source.html">monitor_util.c</a> 파일의 <a class="el" href="monitor__util_8c_source.html#l00119">119</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><pre class="fragment">{
<span class="preprocessor">    #ifdef CONFIG_BITVISOR</span>
<span class="preprocessor"></span>        unmapmem (hva, size);
<span class="preprocessor">    #else</span>
<span class="preprocessor"></span>        <span class="comment">//Noop</span>
<span class="preprocessor">    #endif</span>
<span class="preprocessor"></span>}
</pre></div>
<p><div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="monitor__util_8h_ae5b8234f7d553177a9d3f932fe1c112b_icgraph.png" border="0" usemap="#monitor__util_8h_ae5b8234f7d553177a9d3f932fe1c112b_icgraph" alt=""/></div>
<map name="monitor__util_8h_ae5b8234f7d553177a9d3f932fe1c112b_icgraph" id="monitor__util_8h_ae5b8234f7d553177a9d3f932fe1c112b_icgraph">
<area shape="rect" id="node3" href="guest___i_a32e_page_8h.html#af233f3d87b0a388e0c534d928167e20a" title="Traverse all pages based on IA32e paging mode. It traverse at PML4 level." alt="" coords="1012,220,1151,249"/><area shape="rect" id="node11" href="guest___i_a32e_page_8h.html#acc5be7aa7fcf4568891e6620f0b94141" title="Traverse all pages based on IA32e paging mode. It traverse at page directory pointer (PDP) level..." alt="" coords="824,220,963,249"/><area shape="rect" id="node14" href="guest___i_a32e_page_8h.html#a7253467a3aa5a9560748b75c4b7c57d5" title="Traverse all pages based on IA32e paging mode. It traverse at page directory (PD) level..." alt="" coords="645,245,776,275"/><area shape="rect" id="node17" href="guest___i_a32e_page_8h.html#ab5dc18fd91ff94f88a941b35972f43ad" title="Traverse all pages based on IA32e paging mode. It traverse at page table (PT) level." alt="" coords="471,296,591,325"/><area shape="rect" id="node20" href="memory__ownership__table_8c.html#af13e8ca1a88180df93e4af4db30e3244" title="Set the a frame to closed state." alt="" coords="669,605,752,635"/><area shape="rect" id="node23" href="memory__ownership__table_8c.html#abf5fe4889dc29561c6131dc40c59fc61" title="change a page&#39;s status" alt="" coords="465,605,596,635"/><area shape="rect" id="node26" href="monitor__util_8c.html#a19ca3fbdba02a8a291fbf56b030e7323" title="This function converts guest physical address to host physical address." alt="" coords="193,345,279,375"/><area shape="rect" id="node5" href="guest__state_8h.html#a3d8f41db587aed7fce30c4edcd4aaaf6" title="Traverse all pages that start from startGPAofPageTable and do something for each page." alt="" coords="1200,387,1341,416"/><area shape="rect" id="node7" href="memory__ownership__table_8c.html#aa0e8340e3e2dc314a25b0c93fdfd54ab" title="Start to protect of currently running process&#39;s pages." alt="" coords="1391,483,1559,512"/><area shape="rect" id="node9" href="event_handler_8h.html#a89bbf08a67ab2dc3c540ee1cb1904535" title="This function handles hypercall invoked from guest application. &#160;The goal of this function is to star..." alt="" coords="1608,483,1731,512"/><area shape="rect" id="node34" href="monitor__util_8h.html#a19ca3fbdba02a8a291fbf56b030e7323" title="This function converts guest physical address to host physical address." alt="" coords="329,472,415,501"/><area shape="rect" id="node43" href="unit__test_8c.html#a9a5ea09666782de7674e77cb9211aa9f" title="A testing function for [gpaToHPA](gpaToHPA)" alt="" coords="473,349,588,379"/><area shape="rect" id="node45" href="unit__test_8c.html#a4b454bbf54829d209850a8efa639b942" title="A function to start unit test." alt="" coords="672,349,749,379"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>모두</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>데이타 구조</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>파일들</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>함수</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>변수</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>타입정의</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>열거형 타입</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>열거형 멤버</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>매크로</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
생성시간 : 금 4월 4 2014 00:46:48, 프로젝트명 : Security Monitor, 생성자 :  &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
